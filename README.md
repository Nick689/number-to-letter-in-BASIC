This algorithm seems to be long, but it use branching only, there's no calculation, this is why it is fast.
Maximum input is: 999.999.999.999
